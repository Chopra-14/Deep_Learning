## 1 XOR
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import numpy as np

# XOR Input and Output data
X = np.array([[0,0], [0,1], [1,0], [1,1]], dtype=np.float32)
y = np.array([[0], [1], [1], [0]], dtype=np.float32)

# Build the MLP Model
model = Sequential([
    Dense(4, input_dim=2, activation='relu'),   # Hidden layer with 4 neurons
    Dense(1, activation='sigmoid')              # Output layer with sigmoid for binary output
])

# Compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Train the model
model.fit(X, y, epochs=500, verbose=0)

# Evaluate the model
loss, accuracy = model.evaluate(X, y, verbose=0)
print(f"\nModel Accuracy: {accuracy * 100:.2f}%")

# Predict
predictions = model.predict(X)
print("\nPredictions:")
for i in range(len(X)):
    print(f"Input: {X[i]} -> Predicted: {predictions[i][0]:.4f} -> Class: {int(predictions[i][0] > 0.5)}")
